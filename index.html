<!DOCTYPE html>


<meta charset="utf-8">
<title>BC Data Catalogue Content</title>
<!-- <meta name="description" content="">
<meta name="viewport" content="width=device-width">
<link rel="shortcut icon" href="/favicon.ico"> -->
<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">  
<!-- <link rel="stylesheet" href="http://cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.css">  
 -->
<!-- build:css(.tmp) styles/main.css -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.9/css/jquery.dataTables.css">
<link rel='stylesheet' href="//cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.js">
<!-- {{DOMAIN}}api/3/action/package_search?q=sub_org:"04215a2c-c0b4-4829-a082-bb9467f20e1c"-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<!-- DataTables -->
<script src="https://cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>

  <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <script src="columnfilter.js"></script>
  <script src="spin.js"></script>


<style>
body { font-size: 140%; }
    .spinner {
      position: fixed;
      top: 50%;
      left: 50%;
    }

</style>

<script type="text/javascript">

    var opts = {
      lines: 11, // The number of lines to draw
      length: 15, // The length of each line
      width: 10, // The line thickness
      radius: 30, // The radius of the inner circle
      corners: 1, // Corner roundness (0..1)
      rotate: 0, // The rotation offset
      direction: 1, // 1: clockwise, -1: counterclockwise
      color: '#000', // #rgb or #rrggbb
      speed: 0.6, // Rounds per second
      trail: 60, // Afterglow percentage
      shadow: false, // Whether to render a shadow
      hwaccel: false, // Whether to use hardware acceleration
      className: 'spinner', // The CSS class to assign to the spinner
      zIndex: 2e9, // The z-index (defaults to 2000000000)
      top: 'auto', // Top position relative to parent in px
      left: 'auto' // Left position relative to parent in px
    };
// date picker example https://www.script-tutorials.com/datepicker-jquery-ui/
// var $t = $('#example').DataTable();
    // var counter = 0;
    // var tab;
 
    $(function(){
        var target = document.getElementById('spinner')
        var spinner = new Spinner(opts).spin(target);

        // $.datepicker.setDefaults(
        //   $.extend($.datepicker.regional[''])
        // );
     

        // $('#datepicker').datepicker({});
     
          // onSelect: function(dateText, obj) {
            // var currentDate = "2015-08-02T07:00:00.000Z"//$( "#datepicker" ).datepicker( "getDate" ).toISOString();
            // // var iMin = document.getElementById('datepicker').value;
            // console.log(currentDate)
            // counter +=1
        
                    

            // https://api.bcdevexchange.org/bcdc/3/action/package_search?q=metadata_created:['+currentDate+'%20TO%20*];
            var url = 'https://uat-api.bcdevexchange.org/bcdc/action/package_search?q=&rows=1000';
            $.ajax({
                url: url,
                success: function(data) {
                    if (target) spinner.stop();

                    $('#example').dataTable({
                         "columnDefs": [
                        { "width": "20%", "targets": 0 }
                      ],

                        data: data.result.results,
                        columns: [{
                            data,
                            render: function(data, type, row) {
                                urlstring = 'http://catalogue.data.gov.bc.ca/dataset/' + data['name'];
                                hyperstring = "<a href=" + urlstring + ">" + data['title'] + "</a>";
                                return hyperstring;
                            }
                        }, {
                            data: 'notes'
                        }, {
                            data,
                            render: function(data, type, row) {
                                date = new Date(data['record_publish_date']+'PST')
                                // console.log(new Date(data['record_publish_date']+'PST'))
                                dat = (date.getMonth()+1) +'/' + date.getDate()+ '/' +date.getFullYear()
                                // console.log(new Date(dat))
                                return dat;
                        }
                        }, {
                            data: "license_title"
                        }]
                    }).columnFilter({  sPlaceHolder: "head:after",
                    aoColumns: [    { type: "text" },
                                    { type: "text" },
                                { type: "date-range" },
                                { type: "text" }
                        ]

        });
                }

            });



    });

</script>



<body>


 <div class="container">
        <div class="header">
          <ul class="nav nav-pills pull-right">

        </ul>
        <!-- <h3 class="text-muted">BCDC API Demo Page</h3> -->
    </div>

    <div class="row marketing">
        <div class="col-lg-8">
            <h3>BC Data Catalogue Content</h3>
            <p>Published Public Records</p>
        </div>
    </div>

    <div class="row marketing">
        <div class="col-lg-8">
          <!--   <h4>All Public Records</h4>
            <p>The table below is taken live from the BC Data Catalogue content. </p> -->
            <!-- <p>Date: <input type="text" id="datepicker"></p> -->
           <!--  <div id="external_filter_container_wrapper" class="">
            <label>External filter for Dates column :</label>
            <div id="external_filter_container"></div>
          </div> -->
        </div>
    </div>


    <div class="col-md-10">
        <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">    <thead>
            <tr>
                <th >Title</th>
                <th>Description</th>
                <th>Date Published</th>
                <th style="width:350px">License</th>
            </tr>
            <tr>
                <th >Title</th>
                <th>Description</th>
                <th>Date Published</th>
                <th style="width:350px">License</th>
            </tr>
        </thead>

      <!--   <tfoot>
            <tr>
                <th>title</th>
                <th>notes</th>
                <th>metadata_created</th>
                <th>license</th>
            </tr>
        </tfoot> -->
 <div id='spinner' class='spinner'></div>

    </tbody>
</table>
</div>


<div class="footer">
    <!-- <p>
      Draft 1.03</p> -->
  </div>

</div>




</body>

</html>